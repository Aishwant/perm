import csv
import re
from datetime import datetime

currentFile = "metaFiles/edited.csv"
newFile = "metaFiles/final.csv"

occupationClassifications = {
    '11': "Management Occupations",
    '13': "Business and Financial Operations Occupations",
    '15': "Computer and Mathematical Occupations",
    '17': "Architecture and Engineering Occupations",
    '19': "Life Physical and Social Science Occupations",
    '21': "Community and Social Service Occupations",
    '23': "Legal Occupations",
    '25': "Education, Training, and Library Occupations",
    '27': "Arts, Design, Entertainment, Sports, and Media Occupations",
    '29': "Healthcare Practitioners and Technical Occupations",
    '31': "Healthcare Support Occupations",
    '33': "Protective Service Occupations",
    '35': "Food Preparation and Serving Related Occupations",
    '37': "Building and Grounds Cleaning and Maintenance Occupations",
    '39': "Personal Care and Service Occupations",
    '41': "Sales and Related Occupations",
    '43': "Office and Administrative Support Occupations",
    '45': "Farming, Fishing, and Forestry Occupations",
    '47': "Construction and Extraction Occupations",
    '49': "Installation, Maintenance, and Repair Occupations",
    '51': "Production Occupations",
    '53': "Transportation and Material Moving Occupations",
    '55': "Military Specific Occupations"
}

occupationSubGroup = {
    # 11 - Management Occupations
    "Chief Executives": "Top Executives",
    "General and Operations Managers": "Top Executives",
    "Legislators": "Top Executives",
    "Advertising and Promotions Managers": "Advertising, Marketing, Promotions, Public Relations, and Sales Managers",
    "Marketing Managers": "Advertising, Marketing, Promotions, Public Relations, and Sales Managers",
    "Sales Managers": "Advertising, Marketing, Promotions, Public Relations, and Sales Managers",
    "Public Relations Managers": "Advertising, Marketing, Promotions, Public Relations, and Sales Managers",
    "Administrative Services Managers": "Operations Specialties Managers",
    "Computer and Information Systems Managers": "Operations Specialties Managers",
    "Financial Managers": "Operations Specialties Managers",
    "Compensation and Benefits Managers": "Operations Specialties Managers",
    "Training and Development Managers": "Operations Specialties Managers",
    "Human Resources Managers, All Other": "Operations Specialties Managers",
    "Industrial Production Managers": "Operations Specialties Managers",
    "Purchasing Managers": "Operations Specialties Managers",
    "Transportation, Storage, and Distribution Managers": "Operations Specialties Managers",
    "Farm, Ranch, and Other Agricultural Managers": "Other Management Occupations",
    "Farmers and Ranchers": "Other Management Occupations",
    "Construction Managers": "Other Management Occupations",
    "Education Administrators, Preschool and Child Care Center/Program": "Other Management Occupations",
    "Education Administrators, Elementary and Secondary School": "Other Management Occupations",
    "Education Administrators, Postsecondary": "Other Management Occupations",
    "Education Administrators, All Other": "Other Management Occupations",
    "Engineering Managers": "Other Management Occupations",
    "Food Service Managers": "Other Management Occupations",
    "Funeral Directors": "Other Management Occupations",
    "Gaming Managers": "Other Management Occupations",
    "Lodging Managers": "Other Management Occupations",
    "Medical and Health Services Managers": "Other Management Occupations",
    "Natural Sciences Managers": "Other Management Occupations",
    "Postmasters and Mail Superintendents": "Other Management Occupations",
    "Property, Real Estate, and Community Association Managers": "Other Management Occupations",
    "Social and Community Service Managers": "Other Management Occupations",
    "Managers, All Other": "Other Management Occupations",
    # 13 - Business and Financial Operations
    "Agents and Business Managers of Artists, Performers, and Athletes": "Business Operations Specialists",
    "Purchasing Agents and Buyers, Farm Products": "Business Operations Specialists",
    "Wholesale and Retail Buyers, Except Farm Products": "Business Operations Specialists",
    "Purchasing Agents, Except Wholesale, Retail, and Farm Products": "Business Operations Specialists",
    "Claims Adjusters, Examiners, and Investigators": "Business Operations Specialists",
    "Insurance Appraisers, Auto Damage": "Business Operations Specialists",
    "Compliance Officers, Except Agriculture, Construction, Health and Safety, and Transportation": "Business Operations Specialists",
    "Cost Estimators": "Business Operations Specialists",
    "Emergency Management Specialists": "Business Operations Specialists",
    "Employment, Recruitment, and Placement Specialists": "Business Operations Specialists",
    "Compensation, Benefits, and Job Analysis Specialists": "Business Operations Specialists",
    "Training and Development Specialists": "Business Operations Specialists",
    "Human Resources, Training, and Labor Relations Specialists, All Other": "Business Operations Specialists",
    "Logisticians": "Business Operations Specialists",
    "Management Analysts": "Business Operations Specialists",
    "Meeting and Convention Planners": "Business Operations Specialists",
    "Business Operations Specialists, All Other": "Business Operations Specialists",
    "Accountants and Auditors": "Financial Specialists",
    "Appraisers and Assessors of Real Estate": "Financial Specialists",
    "Budget Analysts": "Financial Specialists",
    "Credit Analysts": "Financial Specialists",
    "Financial Analysts": "Financial Specialists",
    "Personal Financial Advisors": "Financial Specialists",
    "Insurance Underwriters": "Financial Specialists",
    "Financial Examiners": "Financial Specialists",
    "Loan Counselors": "Financial Specialists",
    "Loan Officers": "Financial Specialists",
    "Tax Examiners, Collectors, and Revenue Agents": "Financial Specialists",
    "Tax Preparers": "Financial Specialists",
    "Financial Specialists, All Other": "Financial Specialists",
    # 15 - Computer and Mathematical Occupations
    "Computer and Information Scientists, Research": "Computer Specialists",
    "Computer Programmers": "Computer Specialists",
    "Computer Software Engineers, Applications": "Computer Specialists",
    "Computer Software Engineers, Systems Software": "Computer Specialists",
    "Computer Support Specialists": "Computer Specialists",
    "Computer Systems Analysts": "Computer Specialists",
    "Database Administrators": "Computer Specialists",
    "Network and Computer Systems Administrators": "Computer Specialists",
    "Network Systems and Data Communications Analysts": "Computer Specialists",
    "Computer Specialists, All Other": "Computer Specialists",
    "Actuaries": "Mathematical Science Occupations",
    "Mathematicians": "Mathematical Science Occupations",
    "Operations Research Analysts": "Mathematical Science Occupations",
    "Statisticians": "Mathematical Science Occupations",
    "Mathematical Technicians": "Mathematical Science Occupations",
    "Mathematical Science Occupations, All Other": "Mathematical Science Occupations",
    ### Add ###
    "Web Developers": "Computer Specialists",
    "Web Administrators": "Computer Specialists",
    "Information Security Analysts, Web Developers, and Computer Network Architects": "Computer Specialists",
    "Computer Systems Engineers/Architects": "Computer Specialists",
    "Computer Network Architects": "Computer Specialists",
    "Computer Network Support Specialists": "Computer Specialists",
    "Computer User Support Specialists": "Computer Specialists",
    # 17 - Architecture and Engineering Occupations
    "Architects, Except Landscape and Naval": "Architects, Surveyors, and Cartographers",
    "Landscape Architects": "Architects, Surveyors, and Cartographers",
    "Cartographers and Photogrammetrists": "Architects, Surveyors, and Cartographers",
    "Surveyors": "Architects, Surveyors, and Cartographers",
    "Aerospace Engineers": "Engineers",
    "Agricultural Engineers": "Engineers",
    "Biomedical Engineers": "Engineers",
    "Chemical Engineers": "Engineers",
    "Civil Engineers": "Engineers",
    "Computer Hardware Engineers": "Engineers",
    "Electrical Engineers": "Engineers",
    "Electronics Engineers, Except Computer": "Engineers",
    "Environmental Engineers": "Engineers",
    "Health and Safety Engineers, Except Mining Safety Engineers and Inspectors": "Engineers",
    "Industrial Engineers": "Engineers",
    "Marine Engineers and Naval Architects": "Engineers",
    "Materials Engineers": "Engineers",
    "Mechanical Engineers": "Engineers",
    "Mining and Geological Engineers, Including Mining Safety Engineers": "Engineers",
    "Nuclear Engineers": "Engineers",
    "Petroleum Engineers": "Engineers",
    "Engineers, All Other": "Engineers",
    "Architectural and Civil Drafters": "Drafters, Engineering, and Mapping Technicians",
    "Electrical and Electronics Drafters": "Drafters, Engineering, and Mapping Technicians",
    "Mechanical Drafters": "Drafters, Engineering, and Mapping Technicians",
    "Drafters, All Other": "Drafters, Engineering, and Mapping Technicians",
    "Aerospace Engineering and Operations Technicians": "Drafters, Engineering, and Mapping Technicians",
    "Civil Engineering Technicians": "Drafters, Engineering, and Mapping Technicians",
    "Electrical and Electronic Engineering Technicians": "Drafters, Engineering, and Mapping Technicians",
    "Electro-Mechanical Technicians": "Drafters, Engineering, and Mapping Technicians",
    "Environmental Engineering Technicians": "Drafters, Engineering, and Mapping Technicians",
    "Industrial Engineering Technicians": "Drafters, Engineering, and Mapping Technicians",
    "Mechanical Engineering Technicians": "Drafters, Engineering, and Mapping Technicians",
    "Engineering Technicians, Except Drafters, All Other": "Drafters, Engineering, and Mapping Technicians",
    "Surveying and Mapping Technicians": "Drafters, Engineering, and Mapping Technicians",
    # 19 - Life, Physical and Social Science Occupations
    "Animal Scientists": "Life Scientists",
    "Food Scientists and Technologists": "Life Scientists",
    "Soil and Plant Scientists": "Life Scientists",
    "Biochemists and Biophysicists": "Life Scientists",
    "Microbiologists": "Life Scientists",
    "Zoologists and Wildlife Biologists": "Life Scientists",
    "Biological Scientists, All Other": "Life Scientists",
    "Conservation Scientists": "Life Scientists",
    "Foresters": "Life Scientists",
    "Epidemiologists": "Life Scientists",
    "Medical Scientists, Except Epidemiologists": "Life Scientists",
    "Life Scientists, All Other": "Life Scientists",
    "Astronomers": "Physical Scientists",
    "Physicists": "Physical Scientists",
    "Atmospheric and Space Scientists": "Physical Scientists",
    "Chemists": "Physical Scientists",
    "Materials Scientists": "Physical Scientists",
    "Environmental Scientists and Specialists, Including Health": "Physical Scientists",
    "Geoscientists, Except Hydrologists and Geographers": "Physical Scientists",
    "Hydrologists": "Physical Scientists",
    "Physical Scientists, All Other": "Physical Scientists",
    "Economists": "Social Scientists and Related Workers",
    "Market Research Analysts": "Social Scientists and Related Workers",
    "Survey Researchers": "Social Scientists and Related Workers",
    "Clinical, Counseling, and School Psychologists": "Social Scientists and Related Workers",
    "Industrial-Organizational Psychologists": "Social Scientists and Related Workers",
    "Psychologists, All Other": "Social Scientists and Related Workers",
    "Sociologists": "Social Scientists and Related Workers",
    "Urban and Regional Planners": "Social Scientists and Related Workers",
    "Anthropologists and Archeologists": "Social Scientists and Related Workers",
    "Geographers": "Social Scientists and Related Workers",
    "Historians": "Social Scientists and Related Workers",
    "Political Scientists": "Social Scientists and Related Workers",
    "Social Scientists and Related Workers, All Other": "Social Scientists and Related Workers",
    "Agricultural and Food Science Technicians": "Life, Physical, and Social Science Technicians",
    "Biological Technicians": "Life, Physical, and Social Science Technicians",
    "Chemical Technicians": "Life, Physical, and Social Science Technicians",
    "Geological and Petroleum Technicians": "Life, Physical, and Social Science Technicians",
    "Nuclear Technicians": "Life, Physical, and Social Science Technicians",
    "Social Science Research Assistants": "Life, Physical, and Social Science Technicians",
    "Environmental Science and Protection Technicians, Including Health": "Life, Physical, and Social Science Technicians",
    "Forensic Science Technicians": "Life, Physical, and Social Science Technicians",
    "Forest and Conservation Technicians": "Life, Physical, and Social Science Technicians",
    "Life, Physical, and Social Science Technicians, All Other": "Life, Physical, and Social Science Technicians",
    # 21 - Community and Social Services Occupations
    "Substance Abuse and Behavioral Disorder Counselors": "Social Service Specialists",
    "Educational, Vocational, and School Counselors": "Social Service Specialists",
    "Marriage and Family Therapists": "Social Service Specialists",
    "Mental Health Counselors": "Social Service Specialists",
    "Rehabilitation Counselors": "Social Service Specialists",
    "Counselors, All Other": "Social Service Specialists",
    "Child, Family, and School Social Workers": "Social Service Specialists",
    "Medical and Public Health Social Workers": "Social Service Specialists",
    "Mental Health and Substance Abuse Social Workers": "Social Service Specialists",
    "Social Workers, All Other": "Social Service Specialists",
    "Health Educators": "Social Service Specialists",
    "Probation Officers and Correctional Treatment Specialists": "Social Service Specialists",
    "Social and Human Service Assistants": "Social Service Specialists",
    "Community and Social Service Specialists, All Other": "Social Service Specialists",
    "Clergy": "Religious Workers",
    "Directors, Religious Activities and Education": "Religious Workers",
    "Religious Workers, All Other": "Religious Workers",
    # 23 - Legal Occupations
    "Lawyers": "Lawyers, Judges, and Related Workers",
    "Administrative Law Judges, Adjudicators, and Hearing Officers": "Lawyers, Judges, and Related Workers",
    "Arbitrators, Mediators, and Conciliators": "Lawyers, Judges, and Related Workers",
    "Judges, Magistrate Judges, and Magistrates": "Lawyers, Judges, and Related Workers",
    "Paralegals and Legal Assistants": "Legal Support Workers",
    "Court Reporters": "Legal Support Workers",
    "Law Clerks": "Legal Support Workers",
    "Title Examiners, Abstractors, and Searchers": "Legal Support Workers",
    "Legal Support Workers, All Other": "Legal Support Workers",
    # 25 - Education, Training, and Library Occupations
    "Business Teachers, Postsecondary": "Postsecondary Teachers",
    "Computer Science Teachers, Postsecondary": "Postsecondary Teachers",
    "Mathematical Science Teachers, Postsecondary": "Postsecondary Teachers",
    "Architecture Teachers, Postsecondary": "Postsecondary Teachers",
    "Engineering Teachers, Postsecondary": "Postsecondary Teachers",
    "Agricultural Sciences Teachers, Postsecondary": "Postsecondary Teachers",
    "Biological Science Teachers, Postsecondary": "Postsecondary Teachers",
    "Forestry and Conservation Science Teachers, Postsecondary": "Postsecondary Teachers",
    "Atmospheric, Earth, Marine, and Space Sciences Teachers, Postsecondary": "Postsecondary Teachers",
    "Chemistry Teachers, Postsecondary": "Postsecondary Teachers",
    "Environmental Science Teachers, Postsecondary": "Postsecondary Teachers",
    "Physics Teachers, Postsecondary": "Postsecondary Teachers",
    "Anthropology and Archeology Teachers, Postsecondary": "Postsecondary Teachers",
    "Area, Ethnic, and Cultural Studies Teachers, Postsecondary": "Postsecondary Teachers",
    "Economics Teachers, Postsecondary": "Postsecondary Teachers",
    "Geography Teachers, Postsecondary": "Postsecondary Teachers",
    "Political Science Teachers, Postsecondary": "Postsecondary Teachers",
    "Psychology Teachers, Postsecondary": "Postsecondary Teachers",
    "Sociology Teachers, Postsecondary": "Postsecondary Teachers",
    "Social Sciences Teachers, Postsecondary, All Other": "Postsecondary Teachers",
    "Health Specialties Teachers, Postsecondary": "Postsecondary Teachers",
    "Nursing Instructors and Teachers, Postsecondary": "Postsecondary Teachers",
    "Education Teachers, Postsecondary": "Postsecondary Teachers",
    "Library Science Teachers, Postsecondary": "Postsecondary Teachers",
    "Criminal Justice and Law Enforcement Teachers, Postsecondary": "Postsecondary Teachers",
    "Law Teachers, Postsecondary": "Postsecondary Teachers",
    "Social Work Teachers, Postsecondary": "Postsecondary Teachers",
    "Art, Drama, and Music Teachers, Postsecondary": "Postsecondary Teachers",
    "Communications Teachers, Postsecondary": "Postsecondary Teachers",
    "English Language and Literature Teachers, Postsecondary": "Postsecondary Teachers",
    "Foreign Language and Literature Teachers, Postsecondary": "Postsecondary Teachers",
    "History Teachers, Postsecondary": "Postsecondary Teachers",
    "Philosophy and Religion Teachers, Postsecondary": "Postsecondary Teachers",
    "Graduate Teaching Assistants": "Postsecondary Teachers",
    "Home Economics Teachers, Postsecondary": "Postsecondary Teachers",
    "Recreation and Fitness Studies Teachers, Postsecondary": "Postsecondary Teachers",
    "Vocational Education Teachers, Postsecondary": "Postsecondary Teachers",
    "Postsecondary Teachers, All Other": "Postsecondary Teachers",
    "Preschool Teachers, Except Special Education": "Primary, Secondary, and Special Education School Teachers",
    "Kindergarten Teachers, Except Special Education": "Primary, Secondary, and Special Education School Teachers",
    "Elementary School Teachers, Except Special Education": "Primary, Secondary, and Special Education School Teachers",
    "Middle School Teachers, Except Special and Vocational Education": "Primary, Secondary, and Special Education School Teachers",
    "Vocational Education Teachers, Middle School": "Primary, Secondary, and Special Education School Teachers",
    "Secondary School Teachers, Except Special and Vocational Education": "Primary, Secondary, and Special Education School Teachers",
    "Vocational Education Teachers, Secondary School": "Primary, Secondary, and Special Education School Teachers",
    "Special Education Teachers, Preschool, Kindergarten, and Elementary School": "Primary, Secondary, and Special Education School Teachers",
    "Special Education Teachers, Middle School": "Primary, Secondary, and Special Education School Teachers",
    "Special Education Teachers, Secondary School": "Primary, Secondary, and Special Education School Teachers",
    "Adult Literacy, Remedial Education, and GED Teachers and Instructors": "Other Teachers and Instructors",
    "Self-Enrichment Education Teachers": "Other Teachers and Instructors",
    "Teachers and Instructors, All Other": "Other Teachers and Instructors",
    "Archivists": "Librarians, Curators, and Archivists",
    "Curators": "Librarians, Curators, and Archivists",
    "Museum Technicians and Conservators": "Librarians, Curators, and Archivists",
    "Librarians": "Librarians, Curators, and Archivists",
    "Library Technicians": "Librarians, Curators, and Archivists",
    "Audio-Visual Collections Specialists": "Other Education, Training, and Library Occupations",
    "Farm and Home Management Advisors": "Other Education, Training, and Library Occupations",
    "Instructional Coordinators": "Other Education, Training, and Library Occupations",
    "Teacher Assistants": "Other Education, Training, and Library Occupations",
    "Education, Training, and Library Workers, All Other": "Other Education, Training, and Library Occupations",
    # 27 - Arts, Design, Entertainment, Sports and Media
    "Art Directors": "Art and Design Workers",
    "Craft Artists": "Art and Design Workers",
    "Fine Artists, Including Painters, Sculptors, and Illustrators": "Art and Design Workers",
    "Multi-Media Artists and Animators": "Art and Design Workers",
    "Artists and Related Workers, All Other": "Art and Design Workers",
    "Commercial and Industrial Designers": "Art and Design Workers",
    "Fashion Designers": "Art and Design Workers",
    "Floral Designers": "Art and Design Workers",
    "Graphic Designers": "Art and Design Workers",
    "Interior Designers": "Art and Design Workers",
    "Merchandise Displayers and Window Trimmers": "Art and Design Workers",
    "Set and Exhibit Designers": "Art and Design Workers",
    "Designers, All Other": "Art and Design Workers",
    "Actors": "Entertainers and Performers, Sports and Related Workers",
    "Producers and Directors": "Entertainers and Performers, Sports and Related Workers",
    "Athletes and Sports Competitors": "Entertainers and Performers, Sports and Related Workers",
    "Coaches and Scouts": "Entertainers and Performers, Sports and Related Workers",
    "Umpires, Referees, and Other Sports Officials": "Entertainers and Performers, Sports and Related Workers",
    "Dancers": "Entertainers and Performers, Sports and Related Workers",
    "Choreographers": "Entertainers and Performers, Sports and Related Workers",
    "Music Directors and Composers": "Entertainers and Performers, Sports and Related Workers",
    "Musicians and Singers": "Entertainers and Performers, Sports and Related Workers",
    "Entertainers and Performers, Sports and Related Workers, All Other": "Entertainers and Performers, Sports and Related Workers",
    "Radio and Television Announcers": "Media and Communication Workers",
    "Public Address System and Other Announcers": "Media and Communication Workers",
    "Broadcast News Analysts": "Media and Communication Workers",
    "Reporters and Correspondents": "Media and Communication Workers",
    "Public Relations Specialists": "Media and Communication Workers",
    "Editors": "Media and Communication Workers",
    "Technical Writers": "Media and Communication Workers",
    "Writers and Authors": "Media and Communication Workers",
    "Interpreters and Translators": "Media and Communication Workers",
    "Media and Communication Workers, All Other": "Media and Communication Workers",
    "Audio and Video Equipment Technicians": "Media and Communication Equipment Workers",
    "Broadcast Technicians": "Media and Communication Equipment Workers",
    "Radio Operators": "Media and Communication Equipment Workers",
    "Sound Engineering Technicians": "Media and Communication Equipment Workers",
    "Photographers": "Media and Communication Equipment Workers",
    "Camera Operators, Television, Video, and Motion Picture": "Media and Communication Equipment Workers",
    "Film and Video Editors": "Media and Communication Equipment Workers",
    "Media and Communication Equipment Workers, All Other": "Media and Communication Equipment Workers",
    # 29 - Healthcare Practitioners and Technical Occupations
    "Chiropractors": "Health Diagnosing and Treating Practitioners",
    "Dentists, General": "Health Diagnosing and Treating Practitioners",
    "Oral and Maxillofacial Surgeons": "Health Diagnosing and Treating Practitioners",
    "Orthodontists": "Health Diagnosing and Treating Practitioners",
    "Prosthodontists": "Health Diagnosing and Treating Practitioners",
    "Dentists, All Other Specialists": "Health Diagnosing and Treating Practitioners",
    "Dietitians and Nutritionists": "Health Diagnosing and Treating Practitioners",
    "Optometrists": "Health Diagnosing and Treating Practitioners",
    "Pharmacists": "Health Diagnosing and Treating Practitioners",
    "Anesthesiologists": "Health Diagnosing and Treating Practitioners",
    "Family and General Practitioners": "Health Diagnosing and Treating Practitioners",
    "Internists, General": "Health Diagnosing and Treating Practitioners",
    "Obstetricians and Gynecologists": "Health Diagnosing and Treating Practitioners",
    "Pediatricians, General": "Health Diagnosing and Treating Practitioners",
    "Psychiatrists": "Health Diagnosing and Treating Practitioners",
    "Surgeons": "Health Diagnosing and Treating Practitioners",
    "Physicians and Surgeons, All Other": "Health Diagnosing and Treating Practitioners",
    "Physician Assistants": "Health Diagnosing and Treating Practitioners",
    "Podiatrists": "Health Diagnosing and Treating Practitioners",
    "Registered Nurses": "Health Diagnosing and Treating Practitioners",
    "Audiologists": "Health Diagnosing and Treating Practitioners",
    "Occupational Therapists": "Health Diagnosing and Treating Practitioners",
    "Physical Therapists": "Health Diagnosing and Treating Practitioners",
    "Radiation Therapists": "Health Diagnosing and Treating Practitioners",
    "Recreational Therapists": "Health Diagnosing and Treating Practitioners",
    "Respiratory Therapists": "Health Diagnosing and Treating Practitioners",
    "Speech-Language Pathologists": "Health Diagnosing and Treating Practitioners",
    "Therapists, All Other": "Health Diagnosing and Treating Practitioners",
    "Veterinarians": "Health Diagnosing and Treating Practitioners",
    "Health Diagnosing and Treating Practitioners, All Other": "Health Diagnosing and Treating Practitioners",
    "Medical and Clinical Laboratory Technologists": "Health Technologists and Technicians",
    "Medical and Clinical Laboratory Technicians": "Health Technologists and Technicians",
    "Dental Hygienists": "Health Technologists and Technicians",
    "Cardiovascular Technologists and Technicians": "Health Technologists and Technicians",
    "Diagnostic Medical Sonographers": "Health Technologists and Technicians",
    "Nuclear Medicine Technologists": "Health Technologists and Technicians",
    "Radiologic Technologists and Technicians": "Health Technologists and Technicians",
    "Emergency Medical Technicians and Paramedics": "Health Technologists and Technicians",
    "Dietetic Technicians": "Health Technologists and Technicians",
    "Pharmacy Technicians": "Health Technologists and Technicians",
    "Psychiatric Technicians": "Health Technologists and Technicians",
    "Respiratory Therapy Technicians": "Health Technologists and Technicians",
    "Surgical Technologists": "Health Technologists and Technicians",
    "Veterinary Technologists and Technicians": "Health Technologists and Technicians",
    "Licensed Practical and Licensed Vocational Nurses": "Health Technologists and Technicians",
    "Medical Records and Health Information Technicians": "Health Technologists and Technicians",
    "Opticians, Dispensing": "Health Technologists and Technicians",
    "Orthotists and Prosthetists": "Health Technologists and Technicians",
    "Health Technologists and Technicians, All Other": "Health Technologists and Technicians",
    "Occupational Health and Safety Specialists": "Other Healthcare Practitioners and Technical Occupations",
    "Occupational Health and Safety Technicians": "Other Healthcare Practitioners and Technical Occupations",
    "Athletic Trainers": "Other Healthcare Practitioners and Technical Occupations",
    "Healthcare Practitioners and Technical Workers, All Other": "Other Healthcare Practitioners and Technical Occupations",
    # 31 - Healthcare Support Occupations
    "Home Health Aides": "Nursing, Psychiatric, and Home Health Aides",
    "Nursing Aides, Orderlies, and Attendants": "Nursing, Psychiatric, and Home Health Aides",
    "Psychiatric Aides": "Nursing, Psychiatric, and Home Health Aides",
    "Occupational Therapist Assistants": "Occupational and Physical Therapist Assistants and Aides",
    "Occupational Therapist Aides": "Occupational and Physical Therapist Assistants and Aides",
    "Physical Therapist Assistants": "Occupational and Physical Therapist Assistants and Aides",
    "Physical Therapist Aides": "Occupational and Physical Therapist Assistants and Aides",
    "Massage Therapists": "Other Healthcare Support Occupations",
    "Dental Assistants": "Other Healthcare Support Occupations",
    "Medical Assistants": "Other Healthcare Support Occupations",
    "Medical Equipment Preparers": "Other Healthcare Support Occupations",
    "Medical Transcriptionists": "Other Healthcare Support Occupations",
    "Pharmacy Aides": "Other Healthcare Support Occupations",
    "Veterinary Assistants and Laboratory Animal Caretakers": "Other Healthcare Support Occupations",
    "Healthcare Support Workers, All Other": "Other Healthcare Support Occupations",
    # 33- Protective Service Occupations
    "First-Line Supervisors/Managers of Correctional Officers": "First-Line Supervisors/Managers, Protective Service Workers",
    "First-Line Supervisors/Managers of Police and Detectives": "First-Line Supervisors/Managers, Protective Service Workers",
    "First-Line Supervisors/Managers of Fire Fighting and Prevention Workers": "First-Line Supervisors/Managers, Protective Service Workers",
    "First-Line Supervisors/Managers, Protective Service Workers, All Other": "First-Line Supervisors/Managers, Protective Service Workers",
    "Fire Fighters": "Fire Fighting and Prevention Workers",
    "Fire Inspectors and Investigators": "Fire Fighting and Prevention Workers",
    "Forest Fire Inspectors and Prevention Specialists": "Fire Fighting and Prevention Workers",
    "Bailiffs": "Law Enforcement Workers",
    "Correctional Officers and Jailers": "Law Enforcement Workers",
    "Detectives and Criminal Investigators": "Law Enforcement Workers",
    "Fish and Game Wardens": "Law Enforcement Workers",
    "Parking Enforcement Workers": "Law Enforcement Workers",
    "Police and Sheriff's Patrol Officers": "Law Enforcement Workers",
    "Transit and Railroad Police": "Law Enforcement Workers",
    "Animal Control Workers": "Other Protective Service Workers",
    "Private Detectives and Investigators": "Other Protective Service Workers",
    "Gaming Surveillance Officers and Gaming Investigators": "Other Protective Service Workers",
    "Security Guards": "Other Protective Service Workers",
    "Crossing Guards": "Other Protective Service Workers",
    "Lifeguards, Ski Patrol, and Other Recreational Protective Service Workers": "Other Protective Service Workers",
    "Protective Service Workers, All Other": "Other Protective Service Workers",
    # 35 - Food Preparation and Serving Related
    "Chefs and Head Cooks": "Supervisors, Food Preparation and Serving Workers",
    "First-Line Supervisors/Managers of Food Preparation and Serving Workers": "Supervisors, Food Preparation and Serving Workers",
    "Cooks, Fast Food": "Cooks and Food Preparation Workers",
    "Cooks, Institution and Cafeteria": "Cooks and Food Preparation Workers",
    "Cooks, Private Household": "Cooks and Food Preparation Workers",
    "Cooks, Restaurant": "Cooks and Food Preparation Workers",
    "Cooks, Short Order": "Cooks and Food Preparation Workers",
    "Cooks, All Other": "Cooks and Food Preparation Workers",
    "Food Preparation Workers": "Cooks and Food Preparation Workers",
    "Bartenders": "Food and Beverage Serving Workers",
    "Combined Food Preparation and Serving Workers, Including Fast Food": "Food and Beverage Serving Workers",
    "Counter Attendants, Cafeteria, Food Concession, and Coffee Shop": "Food and Beverage Serving Workers",
    "Waiters and Waitresses": "Food and Beverage Serving Workers",
    "Food Servers, Nonrestaurant": "Food and Beverage Serving Workers",
    "Dining Room and Cafeteria Attendants and Bartender Helpers": "Other Food Preparation and Serving Related Workers",
    "Dishwashers": "Other Food Preparation and Serving Related Workers",
    "Hosts and Hostesses, Restaurant, Lounge, and Coffee Shop": "Other Food Preparation and Serving Related Workers",
    "Food Preparation and Serving Related Workers, All Other": "Other Food Preparation and Serving Related Workers",
    # 37 - Building and Grounds Cleaning and Maintenance
    "First-Line Supervisors/Managers of Housekeeping and Janitorial Workers": "Supervisors, Building and Grounds Cleaning and Maintenance Workers",
    "First-Line Supervisors/Managers of Landscaping, Lawn Service, and Groundskeeping Workers": "Supervisors, Building and Grounds Cleaning and Maintenance Workers",
    "Janitors and Cleaners, Except Maids and Housekeeping Cleaners": "Building Cleaning and Pest Control Workers",
    "Maids and Housekeeping Cleaners": "Building Cleaning and Pest Control Workers",
    "Building Cleaning Workers, All Other": "Building Cleaning and Pest Control Workers",
    "Pest Control Workers": "Building Cleaning and Pest Control Workers",
    "Landscaping and Groundskeeping Workers": "Grounds Maintenance Workers",
    "Pesticide Handlers, Sprayers, and Applicators, Vegetation": "Grounds Maintenance Workers",
    "Tree Trimmers and Pruners": "Grounds Maintenance Workers",
    "Grounds Maintenance Workers, All Other": "Grounds Maintenance Workers",
    # 39 - Personal Care and Service Occupations
    "Gaming Supervisors": "Supervisors, Personal Care and Service Workers",
    "Slot Key Persons": "Supervisors, Personal Care and Service Workers",
    "First-Line Supervisors/Managers of Personal Service Workers": "Supervisors, Personal Care and Service Workers",
    "Animal Trainers": "Animal Care and Service Workers",
    "Nonfarm Animal Caretakers": "Animal Care and Service Workers",
    "Gaming Dealers": "Entertainment Attendants and Related Workers",
    "Gaming and Sports Book Writers and Runners": "Entertainment Attendants and Related Workers",
    "Gaming Service Workers, All Other": "Entertainment Attendants and Related Workers",
    "Motion Picture Projectionists": "Entertainment Attendants and Related Workers",
    "Ushers, Lobby Attendants, and Ticket Takers": "Entertainment Attendants and Related Workers",
    "Amusement and Recreation Attendants": "Entertainment Attendants and Related Workers",
    "Costume Attendants": "Entertainment Attendants and Related Workers",
    "Locker Room, Coatroom, and Dressing Room Attendants": "Entertainment Attendants and Related Workers",
    "Entertainment Attendants and Related Workers, All Other": "Entertainment Attendants and Related Workers",
    "Embalmers": "Funeral Service Workers",
    "Funeral Attendants": "Funeral Service Workers",
    "Barbers": "Personal Appearance Workers",
    "Hairdressers, Hairstylists, and Cosmetologists": "Personal Appearance Workers",
    "Makeup Artists, Theatrical and Performance": "Personal Appearance Workers",
    "Manicurists and Pedicurists": "Personal Appearance Workers",
    "Shampooers": "Personal Appearance Workers",
    "Skin Care Specialists": "Personal Appearance Workers",
    "Baggage Porters and Bellhops": "Baggage Porters and Bellhops",
    "Concierges": "Transportation, Tourism, and Lodging Attendants",
    "Tour Guides and Escorts": "Transportation, Tourism, and Lodging Attendants",
    "Travel Guides": "Transportation, Tourism, and Lodging Attendants",
    "Flight Attendants": "Transportation, Tourism, and Lodging Attendants",
    "Transportation Attendants, Except Flight Attendants and Baggage Porters": "Transportation, Tourism, and Lodging Attendants",
    "Child Care Workers": "Other Personal Care and Service Workers",
    "Personal and Home Care Aides": "Other Personal Care and Service Workers",
    "Fitness Trainers and Aerobics Instructors": "Other Personal Care and Service Workers",
    "Recreation Workers": "Other Personal Care and Service Workers",
    "Residential Advisors": "Other Personal Care and Service Workers",
    "Personal Care and Service Workers, All Other": "Other Personal Care and Service Workers",
    # 41 - Sales and Related Occupations
    "First-Line Supervisors/Managers of Retail Sales Workers": "Supervisors, Sales Workers",
    "First-Line Supervisors/Managers of Non-Retail Sales Workers": "Supervisors, Sales Workers",
    "Cashiers": "Retail Sales Workers",
    "Gaming Change Persons and Booth Cashiers": "Retail Sales Workers",
    "Counter and Rental Clerks": "Retail Sales Workers",
    "Parts Salespersons": "Retail Sales Workers",
    "Retail Salespersons": "Retail Sales Workers",
    "Advertising Sales Agents": "Sales Representatives, Services",
    "Insurance Sales Agents": "Sales Representatives, Services",
    "Securities, Commodities, and Financial Services Sales Agents": "Sales Representatives, Services",
    "Travel Agents": "Sales Representatives, Services",
    "Sales Representatives, Services, All Other": "Sales Representatives, Services",
    "Sales Representatives, Wholesale and Manufacturing, Technical and Scientific Products": "Sales Representatives, Wholesale and Manufacturing",
    "Sales Representatives, Wholesale and Manufacturing, Except Technical and Scientific Products": "Sales Representatives, Wholesale and Manufacturing",
    "Demonstrators and Product Promoters": "Other Sales and Related Workers",
    "Models": "Other Sales and Related Workers",
    "Real Estate Brokers": "Other Sales and Related Workers",
    "Real Estate Sales Agents": "Other Sales and Related Workers",
    "Sales Engineers": "Other Sales and Related Workers",
    "Telemarketers": "Other Sales and Related Workers",
    "Door-to-Door Sales Workers, News and Street Vendors, and Related Workers": "Other Sales and Related Workers",
    "Sales and Related Workers, All Other": "Other Sales and Related Workers",
    # 43 - Office and Administrative Support Occupations
    "First-Line Supervisors/Managers of Office and Administrative Support Workers": "Supervisors, Office and Administrative Support Workers",
    "Switchboard Operators, Including Answering Service": "Communications Equipment Operators",
    "Telephone Operators": "Communications Equipment Operators",
    "Communications Equipment Operators, All Other": "Communications Equipment Operators",
    "Bill and Account Collectors": "Financial Clerks",
    "Billing and Posting Clerks and Machine Operators": "Financial Clerks",
    "Bookkeeping, Accounting, and Auditing Clerks": "Financial Clerks",
    "Gaming Cage Workers": "Financial Clerks",
    "Payroll and Timekeeping Clerks": "Financial Clerks",
    "Procurement Clerks": "Financial Clerks",
    "Tellers": "Financial Clerks",
    "Brokerage Clerks": "Information and Record Clerks",
    "Correspondence Clerks": "Information and Record Clerks",
    "Court, Municipal, and License Clerks": "Information and Record Clerks",
    "Credit Authorizers, Checkers, and Clerks": "Information and Record Clerks",
    "Customer Service Representatives": "Information and Record Clerks",
    "Eligibility Interviewers, Government Programs": "Information and Record Clerks",
    "File Clerks": "Information and Record Clerks",
    "Hotel, Motel, and Resort Desk Clerks": "Information and Record Clerks",
    "Interviewers, Except Eligibility and Loan": "Information and Record Clerks",
    "Library Assistants, Clerical": "Information and Record Clerks",
    "Loan Interviewers and Clerks": "Information and Record Clerks",
    "New Accounts Clerks": "Information and Record Clerks",
    "Order Clerks": "Information and Record Clerks",
    "Human Resources Assistants, Except Payroll and Timekeeping": "Information and Record Clerks",
    "Receptionists and Information Clerks": "Information and Record Clerks",
    "Reservation and Transportation Ticket Agents and Travel Clerks": "Information and Record Clerks",
    "Information and Record Clerks, All Other": "Information and Record Clerks",
    "Cargo and Freight Agents": "Material Recording, Scheduling, Dispatching, and Distributing Workers",
    "Couriers and Messengers": "Material Recording, Scheduling, Dispatching, and Distributing Workers",
    "Police, Fire, and Ambulance Dispatchers": "Material Recording, Scheduling, Dispatching, and Distributing Workers",
    "Dispatchers, Except Police, Fire, and Ambulance": "Material Recording, Scheduling, Dispatching, and Distributing Workers",
    "Meter Readers, Utilities": "Material Recording, Scheduling, Dispatching, and Distributing Workers",
    "Postal Service Clerks": "Material Recording, Scheduling, Dispatching, and Distributing Workers",
    "Postal Service Mail Carriers": "Material Recording, Scheduling, Dispatching, and Distributing Workers",
    "Postal Service Mail Sorters, Processors, and Processing Machine Operators": "Material Recording, Scheduling, Dispatching, and Distributing Workers",
    "Production, Planning, and Expediting Clerks": "Material Recording, Scheduling, Dispatching, and Distributing Workers",
    "Shipping, Receiving, and Traffic Clerks": "Material Recording, Scheduling, Dispatching, and Distributing Workers",
    "Stock Clerks and Order Fillers": "Material Recording, Scheduling, Dispatching, and Distributing Workers",
    "Weighers, Measurers, Checkers, and Samplers, Recordkeeping": "Material Recording, Scheduling, Dispatching, and Distributing Workers",
    "Executive Secretaries and Administrative Assistants": "Secretaries and Administrative Assistants",
    "Legal Secretaries": "Secretaries and Administrative Assistants",
    "Medical Secretaries": "Secretaries and Administrative Assistants",
    "Secretaries, Except Legal, Medical, and Executive": "Secretaries and Administrative Assistants",
    "Computer Operators": "Other Office and Administrative Support Workers",
    "Data Entry Keyers": "Other Office and Administrative Support Workers",
    "Word Processors and Typists": "Other Office and Administrative Support Workers",
    "Desktop Publishers": "Other Office and Administrative Support Workers",
    "Insurance Claims and Policy Processing Clerks": "Other Office and Administrative Support Workers",
    "Mail Clerks and Mail Machine Operators, Except Postal Service": "Other Office and Administrative Support Workers",
    "Office Clerks, General": "Other Office and Administrative Support Workers",
    "Office Machine Operators, Except Computer": "Other Office and Administrative Support Workers",
    "Proofreaders and Copy Markers": "Other Office and Administrative Support Workers",
    "Statistical Assistants": "Other Office and Administrative Support Workers",
    "Office and Administrative Support Workers, All Other": "Other Office and Administrative Support Workers",
    # 45 - Farming, Fishing and Forestry Occupations
    "First-Line Supervisors/Managers of Farming, Fishing, and Forestry Workers": "Supervisors, Farming, Fishing, and Forestry Workers",
    "Farm Labor Contractors": "Supervisors, Farming, Fishing, and Forestry Workers",
    "Agricultural Inspectors": "Agricultural Workers",
    "Animal Breeders": "Agricultural Workers",
    "Graders and Sorters, Agricultural Products": "Agricultural Workers",
    "Agricultural Equipment Operators": "Agricultural Workers",
    "Farmworkers and Laborers, Crop, Nursery, and Greenhouse": "Agricultural Workers",
    "Farmworkers, Farm and Ranch Animals": "Agricultural Workers",
    "Agricultural Workers, All Other": "Agricultural Workers",
    "Fishers and Related Fishing Workers": "Fishing and Hunting Workers",
    "Hunters and Trappers": "Fishing and Hunting Workers",
    "Forest and Conservation Workers": "Forest, Conservation, and Logging Workers",
    "Fallers": "Forest, Conservation, and Logging Workers",
    "Logging Equipment Operators": "Forest, Conservation, and Logging Workers",
    "Log Graders and Scalers": "Forest, Conservation, and Logging Workers",
    "Logging Workers, All Other": "Forest, Conservation, and Logging Workers",
    # 47 - Construction and Extraction Occupations
    "First-Line Supervisors/Managers of Construction Trades and Extraction Workers": "Supervisors, Construction and Extraction Workers",
    "Boilermakers": "Construction Trades Workers",
    "Brickmasons and Blockmasons": "Construction Trades Workers",
    "Stonemasons": "Construction Trades Workers",
    "Carpenters": "Construction Trades Workers",
    "Carpet Installers": "Construction Trades Workers",
    "Floor Layers, Except Carpet, Wood, and Hard Tiles": "Construction Trades Workers",
    "Floor Sanders and Finishers": "Construction Trades Workers",
    "Tile and Marble Setters": "Construction Trades Workers",
    "Cement Masons and Concrete Finishers": "Construction Trades Workers",
    "Terrazzo Workers and Finishers": "Construction Trades Workers",
    "Construction Laborers": "Construction Trades Workers",
    "Paving, Surfacing, and Tamping Equipment Operators": "Construction Trades Workers",
    "Pile-Driver Operators": "Construction Trades Workers",
    "Operating Engineers and Other Construction Equipment Operators": "Construction Trades Workers",
    "Drywall and Ceiling Tile Installers": "Construction Trades Workers",
    "Tapers": "Construction Trades Workers",
    "Electricians": "Construction Trades Workers",
    "Glaziers": "Construction Trades Workers",
    "Insulation Workers, Floor, Ceiling, and Wall": "Construction Trades Workers",
    "Insulation Workers, Mechanical": "Construction Trades Workers",
    "Painters, Construction and Maintenance": "Construction Trades Workers",
    "Paperhangers": "Construction Trades Workers",
    "Pipelayers": "Construction Trades Workers",
    "Plumbers, Pipefitters, and Steamfitters": "Construction Trades Workers",
    "Plasterers and Stucco Masons": "Construction Trades Workers",
    "Reinforcing Iron and Rebar Workers": "Construction Trades Workers",
    "Roofers": "Construction Trades Workers",
    "Sheet Metal Workers": "Construction Trades Workers",
    "Structural Iron and Steel Workers": "Construction Trades Workers",
    "Helpers--Brickmasons, Blockmasons, Stonemasons, and Tile and Marble Setters": "Helpers, Construction Trades",
    "Helpers--Carpenters": "Helpers, Construction Trades",
    "Helpers--Electricians": "Helpers, Construction Trades",
    "Helpers--Painters, Paperhangers, Plasterers, and Stucco Masons": "Helpers, Construction Trades",
    "Helpers--Pipelayers, Plumbers, Pipefitters, and Steamfitters": "Helpers, Construction Trades",
    "Helpers--Roofers": "Helpers, Construction Trades",
    "Helpers, Construction Trades, All Other": "Helpers, Construction Trades",
    "Construction and Building Inspectors": "Other Construction and Related Workers",
    "Elevator Installers and Repairers": "Other Construction and Related Workers",
    "Fence Erectors": "Other Construction and Related Workers",
    "Hazardous Materials Removal Workers": "Other Construction and Related Workers",
    "Highway Maintenance Workers": "Other Construction and Related Workers",
    "Rail-Track Laying and Maintenance Equipment Operators": "Other Construction and Related Workers",
    "Septic Tank Servicers and Sewer Pipe Cleaners": "Other Construction and Related Workers",
    "Segmental Pavers": "Other Construction and Related Workers",
    "Construction and Related Workers, All Other": "Other Construction and Related Workers",
    "Derrick Operators, Oil and Gas": "Extraction Workers",
    "Rotary Drill Operators, Oil and Gas": "Extraction Workers",
    "Service Unit Operators, Oil, Gas, and Mining": "Extraction Workers",
    "Earth Drillers, Except Oil and Gas": "Extraction Workers",
    "Explosives Workers, Ordnance Handling Experts, and Blasters": "Extraction Workers",
    "Continuous Mining Machine Operators": "Extraction Workers",
    "Mine Cutting and Channeling Machine Operators": "Extraction Workers",
    "Mining Machine Operators, All Other": "Extraction Workers",
    "Rock Splitters, Quarry": "Extraction Workers",
    "Roof Bolters, Mining": "Extraction Workers",
    "Roustabouts, Oil and Gas": "Extraction Workers",
    "Helpers--Extraction Workers": "Extraction Workers",
    "Extraction Workers, All Other": "Extraction Workers",
    # 49 - Installation, Maintenance and Repair
    "First-Line Supervisors/Managers of Mechanics, Installers, and Repairers": "Supervisors of Installation, Maintenance, and Repair Workers",
    "Computer, Automated Teller, and Office Machine Repairers": "Electrical and Electronic Equipment Mechanics, Installers, and Repairers",
    "Radio Mechanics": "Electrical and Electronic Equipment Mechanics, Installers, and Repairers",
    "Telecommunications Equipment Installers and Repairers, Except Line Installers": "Electrical and Electronic Equipment Mechanics, Installers, and Repairers",
    "Avionics Technicians": "Electrical and Electronic Equipment Mechanics, Installers, and Repairers",
    "Electric Motor, Power Tool, and Related Repairers": "Electrical and Electronic Equipment Mechanics, Installers, and Repairers",
    "Electrical and Electronics Installers and Repairers, Transportation Equipment": "Electrical and Electronic Equipment Mechanics, Installers, and Repairers",
    "Electrical and Electronics Repairers, Commercial and Industrial Equipment": "Electrical and Electronic Equipment Mechanics, Installers, and Repairers",
    "Electrical and Electronics Repairers, Powerhouse, Substation, and Relay": "Electrical and Electronic Equipment Mechanics, Installers, and Repairers",
    "Electronic Equipment Installers and Repairers, Motor Vehicles": "Electrical and Electronic Equipment Mechanics, Installers, and Repairers",
    "Electronic Home Entertainment Equipment Installers and Repairers": "Electrical and Electronic Equipment Mechanics, Installers, and Repairers",
    "Security and Fire Alarm Systems Installers": "Electrical and Electronic Equipment Mechanics, Installers, and Repairers",
    "Aircraft Mechanics and Service Technicians": "Vehicle and Mobile Equipment Mechanics, Installers, and Repairers",
    "Automotive Body and Related Repairers": "Vehicle and Mobile Equipment Mechanics, Installers, and Repairers",
    "Automotive Glass Installers and Repairers": "Vehicle and Mobile Equipment Mechanics, Installers, and Repairers",
    "Automotive Service Technicians and Mechanics": "Vehicle and Mobile Equipment Mechanics, Installers, and Repairers",
    "Bus and Truck Mechanics and Diesel Engine Specialists": "Vehicle and Mobile Equipment Mechanics, Installers, and Repairers",
    "Farm Equipment Mechanics": "Vehicle and Mobile Equipment Mechanics, Installers, and Repairers",
    "Mobile Heavy Equipment Mechanics, Except Engines": "Vehicle and Mobile Equipment Mechanics, Installers, and Repairers",
    "Rail Car Repairers": "Vehicle and Mobile Equipment Mechanics, Installers, and Repairers",
    "Motorboat Mechanics": "Vehicle and Mobile Equipment Mechanics, Installers, and Repairers",
    "Motorcycle Mechanics": "Vehicle and Mobile Equipment Mechanics, Installers, and Repairers",
    "Outdoor Power Equipment and Other Small Engine Mechanics": "Vehicle and Mobile Equipment Mechanics, Installers, and Repairers",
    "Bicycle Repairers": "Vehicle and Mobile Equipment Mechanics, Installers, and Repairers",
    "Recreational Vehicle Service Technicians": "Vehicle and Mobile Equipment Mechanics, Installers, and Repairers",
    "Tire Repairers and Changers": "Vehicle and Mobile Equipment Mechanics, Installers, and Repairers",
    "Mechanical Door Repairers": "Other Installation, Maintenance, and Repair Occupations",
    "Control and Valve Installers and Repairers, Except Mechanical Door": "Other Installation, Maintenance, and Repair Occupations",
    "Heating, Air Conditioning, and Refrigeration Mechanics and Installers": "Other Installation, Maintenance, and Repair Occupations",
    "Home Appliance Repairers": "Other Installation, Maintenance, and Repair Occupations",
    "Industrial Machinery Mechanics": "Other Installation, Maintenance, and Repair Occupations",
    "Maintenance and Repair Workers, General": "Other Installation, Maintenance, and Repair Occupations",
    "Maintenance Workers, Machinery": "Other Installation, Maintenance, and Repair Occupations",
    "Millwrights": "Other Installation, Maintenance, and Repair Occupations",
    "Refractory Materials Repairers, Except Brickmasons": "Other Installation, Maintenance, and Repair Occupations",
    "Electrical Power-Line Installers and Repairers": "Other Installation, Maintenance, and Repair Occupations",
    "Telecommunications Line Installers and Repairers": "Other Installation, Maintenance, and Repair Occupations",
    "Camera and Photographic Equipment Repairers": "Other Installation, Maintenance, and Repair Occupations",
    "Medical Equipment Repairers": "Other Installation, Maintenance, and Repair Occupations",
    "Musical Instrument Repairers and Tuners": "Other Installation, Maintenance, and Repair Occupations",
    "Watch Repairers": "Other Installation, Maintenance, and Repair Occupations",
    "Precision Instrument and Equipment Repairers, All Other": "Other Installation, Maintenance, and Repair Occupations",
    "Coin, Vending, and Amusement Machine Servicers and Repairers": "Other Installation, Maintenance, and Repair Occupations",
    "Commercial Divers": "Other Installation, Maintenance, and Repair Occupations",
    "Fabric Menders, Except Garment": "Other Installation, Maintenance, and Repair Occupations",
    "Locksmiths and Safe Repairers": "Other Installation, Maintenance, and Repair Occupations",
    "Manufactured Building and Mobile Home Installers": "Other Installation, Maintenance, and Repair Occupations",
    "Riggers": "Other Installation, Maintenance, and Repair Occupations",
    "Signal and Track Switch Repairers": "Other Installation, Maintenance, and Repair Occupations",
    "Helpers--Installation, Maintenance, and Repair Workers": "Other Installation, Maintenance, and Repair Occupations",
    "Installation, Maintenance, and Repair Workers, All Other": "Other Installation, Maintenance, and Repair Occupations",
    # 51 - Production Occupations
    "First-Line Supervisors/Managers of Production and Operating Workers": "Supervisors, Production Workers",
    "Aircraft Structure, Surfaces, Rigging, and Systems Assemblers": "Assemblers and Fabricators",
    "Coil Winders, Tapers, and Finishers": "Assemblers and Fabricators",
    "Electrical and Electronic Equipment Assemblers": "Assemblers and Fabricators",
    "Electromechanical Equipment Assemblers": "Assemblers and Fabricators",
    "Engine and Other Machine Assemblers": "Assemblers and Fabricators",
    "Structural Metal Fabricators and Fitters": "Assemblers and Fabricators",
    "Fiberglass Laminators and Fabricators": "Assemblers and Fabricators",
    "Team Assemblers": "Assemblers and Fabricators",
    "Timing Device Assemblers, Adjusters, and Calibrators": "Assemblers and Fabricators",
    "Assemblers and Fabricators, All Other": "Assemblers and Fabricators",
    "Bakers": "Food Processing Workers",
    "Butchers and Meat Cutters": "Food Processing Workers",
    "Meat, Poultry, and Fish Cutters and Trimmers": "Food Processing Workers",
    "Slaughterers and Meat Packers": "Food Processing Workers",
    "Food and Tobacco Roasting, Baking, and Drying Machine Operators and Tenders": "Food Processing Workers",
    "Food Batchmakers": "Food Processing Workers",
    "Food Cooking Machine Operators and Tenders": "Food Processing Workers",
    "Computer-Controlled Machine Tool Operators, Metal and Plastic": "Metal Workers and Plastic Workers",
    "Numerical Tool and Process Control Programmers": "Metal Workers and Plastic Workers",
    "Extruding and Drawing Machine Setters, Operators, and Tenders, Metal and Plastic": "Metal Workers and Plastic Workers",
    "Forging Machine Setters, Operators, and Tenders, Metal and Plastic": "Metal Workers and Plastic Workers",
    "Rolling Machine Setters, Operators, and Tenders, Metal and Plastic": "Metal Workers and Plastic Workers",
    "Cutting, Punching, and Press Machine Setters, Operators, and Tenders, Metal and Plastic": "Metal Workers and Plastic Workers",
    "Drilling and Boring Machine Tool Setters, Operators, and Tenders, Metal and Plastic": "Metal Workers and Plastic Workers",
    "Grinding, Lapping, Polishing, and Buffing Machine Tool Setters, Operators, and Tenders, Metal and Plastic": "Metal Workers and Plastic Workers",
    "Lathe and Turning Machine Tool Setters, Operators, and Tenders, Metal and Plastic": "Metal Workers and Plastic Workers",
    "Milling and Planing Machine Setters, Operators, and Tenders, Metal and Plastic": "Metal Workers and Plastic Workers",
    "Machinists": "Metal Workers and Plastic Workers",
    "Metal-Refining Furnace Operators and Tenders": "Metal Workers and Plastic Workers",
    "Pourers and Casters, Metal": "Metal Workers and Plastic Workers",
    "Model Makers, Metal and Plastic": "Metal Workers and Plastic Workers",
    "Patternmakers, Metal and Plastic": "Metal Workers and Plastic Workers",
    "Foundry Mold and Coremakers": "Metal Workers and Plastic Workers",
    "Molding, Coremaking, and Casting Machine Setters, Operators, and Tenders, Metal and Plastic": "Metal Workers and Plastic Workers",
    "Multiple Machine Tool Setters, Operators, and Tenders, Metal and Plastic": "Metal Workers and Plastic Workers",
    "Tool and Die Makers": "Metal Workers and Plastic Workers",
    "Welders, Cutters, Solderers, and Brazers": "Metal Workers and Plastic Workers",
    "Welding, Soldering, and Brazing Machine Setters, Operators, and Tenders": "Metal Workers and Plastic Workers",
    "Heat Treating Equipment Setters, Operators, and Tenders, Metal and Plastic": "Metal Workers and Plastic Workers",
    "Lay-Out Workers, Metal and Plastic": "Metal Workers and Plastic Workers",
    "Plating and Coating Machine Setters, Operators, and Tenders, Metal and Plastic": "Metal Workers and Plastic Workers",
    "Tool Grinders, Filers, and Sharpeners": "Metal Workers and Plastic Workers",
    "Metal Workers and Plastic Workers, All Other": "Metal Workers and Plastic Workers",
    "Bindery Workers": "Printing Workers",
    "Bookbinders": "Printing Workers",
    "Job Printers": "Printing Workers",
    "Prepress Technicians and Workers": "Printing Workers",
    "Printing Machine Operators": "Printing Workers",
    "Laundry and Dry-Cleaning Workers": "Textile, Apparel, and Furnishings Workers",
    "Pressers, Textile, Garment, and Related Materials": "Textile, Apparel, and Furnishings Workers",
    "Sewing Machine Operators": "Textile, Apparel, and Furnishings Workers",
    "Shoe and Leather Workers and Repairers": "Textile, Apparel, and Furnishings Workers",
    "Shoe Machine Operators and Tenders": "Textile, Apparel, and Furnishings Workers",
    "Sewers, Hand": "Textile, Apparel, and Furnishings Workers",
    "Tailors, Dressmakers, and Custom Sewers": "Textile, Apparel, and Furnishings Workers",
    "Textile Bleaching and Dyeing Machine Operators and Tenders": "Textile, Apparel, and Furnishings Workers",
    "Textile Cutting Machine Setters, Operators, and Tenders": "Textile, Apparel, and Furnishings Workers",
    "Textile Knitting and Weaving Machine Setters, Operators, and Tenders": "Textile, Apparel, and Furnishings Workers",
    "Textile Winding, Twisting, and Drawing Out Machine Setters, Operators, and Tenders": "Textile, Apparel, and Furnishings Workers",
    "Extruding and Forming Machine Setters, Operators, and Tenders, Synthetic and Glass Fibers": "Textile, Apparel, and Furnishings Workers",
    "Fabric and Apparel Patternmakers": "Textile, Apparel, and Furnishings Workers",
    "Upholsterers": "Textile, Apparel, and Furnishings Workers",
    "Textile, Apparel, and Furnishings Workers, All Other": "Textile, Apparel, and Furnishings Workers",
    "Cabinetmakers and Bench Carpenters": "Woodworkers",
    "Furniture Finishers": "Woodworkers",
    "Model Makers, Wood": "Woodworkers",
    "Patternmakers, Wood": "Woodworkers",
    "Sawing Machine Setters, Operators, and Tenders, Wood": "Woodworkers",
    "Woodworking Machine Setters, Operators, and Tenders, Except Sawing": "Woodworkers",
    "Woodworkers, All Other": "Woodworkers",
    "Nuclear Power Reactor Operators": "Plant and System Operators",
    "Power Distributors and Dispatchers": "Plant and System Operators",
    "Power Plant Operators": "Plant and System Operators",
    "Stationary Engineers and Boiler Operators": "Plant and System Operators",
    "Water and Liquid Waste Treatment Plant and System Operators": "Plant and System Operators",
    "Chemical Plant and System Operators": "Plant and System Operators",
    "Gas Plant Operators": "Plant and System Operators",
    "Petroleum Pump System Operators, Refinery Operators, and Gaugers": "Plant and System Operators",
    "Plant and System Operators, All Other": "Plant and System Operators",
    "Chemical Equipment Operators and Tenders": "Other Production Occupations",
    "Separating, Filtering, Clarifying, Precipitating, and Still Machine Setters, Operators, and Tenders": "Other Production Occupations",
    "Crushing, Grinding, and Polishing Machine Setters, Operators, and Tenders": "Other Production Occupations",
    "Grinding and Polishing Workers, Hand": "Other Production Occupations",
    "Mixing and Blending Machine Setters, Operators, and Tenders": "Other Production Occupations",
    "Cutters and Trimmers, Hand": "Other Production Occupations",
    "Cutting and Slicing Machine Setters, Operators, and Tenders": "Other Production Occupations",
    "Extruding, Forming, Pressing, and Compacting Machine Setters, Operators, and Tenders": "Other Production Occupations",
    "Furnace, Kiln, Oven, Drier, and Kettle Operators and Tenders": "Other Production Occupations",
    "Inspectors, Testers, Sorters, Samplers, and Weighers": "Other Production Occupations",
    "Jewelers and Precious Stone and Metal Workers": "Other Production Occupations",
    "Dental Laboratory Technicians": "Other Production Occupations",
    "Medical Appliance Technicians": "Other Production Occupations",
    "Ophthalmic Laboratory Technicians": "Other Production Occupations",
    "Packaging and Filling Machine Operators and Tenders": "Other Production Occupations",
    "Coating, Painting, and Spraying Machine Setters, Operators, and Tenders": "Other Production Occupations",
    "Painters, Transportation Equipment": "Other Production Occupations",
    "Painting, Coating, and Decorating Workers": "Other Production Occupations",
    "Photographic Process Workers": "Other Production Occupations",
    "Photographic Processing Machine Operators": "Other Production Occupations",
    "Semiconductor Processors": "Other Production Occupations",
    "Cementing and Gluing Machine Operators and Tenders": "Other Production Occupations",
    "Cleaning, Washing, and Metal Pickling Equipment Operators and Tenders": "Other Production Occupations",
    "Cooling and Freezing Equipment Operators and Tenders": "Other Production Occupations",
    "Etchers and Engravers": "Other Production Occupations",
    "Molders, Shapers, and Casters, Except Metal and Plastic": "Other Production Occupations",
    "Paper Goods Machine Setters, Operators, and Tenders": "Other Production Occupations",
    "Tire Builders": "Other Production Occupations",
    "Helpers--Production Workers": "Other Production Occupations",
    "Production Workers, All Other": "Other Production Occupations",
    # 53 - Transportation and Material Moving
    "Aircraft Cargo Handling Supervisors": "Supervisors, Transportation and Material Moving Workers",
    "First-Line Supervisors/Managers of Helpers, Laborers, and Material Movers, Hand": "Supervisors, Transportation and Material Moving Workers",
    "First-Line Supervisors/Managers of Transportation and Material-Moving Machine and Vehicle Operators": "Supervisors, Transportation and Material Moving Workers",
    "Airline Pilots, Copilots, and Flight Engineers": "Air Transportation Workers",
    "Commercial Pilots": "Air Transportation Workers",
    "Air Traffic Controllers": "Air Transportation Workers",
    "Airfield Operations Specialists": "Air Transportation Workers",
    "Ambulance Drivers and Attendants, Except Emergency Medical Technicians": "Motor Vehicle Operators",
    "Bus Drivers, Transit and Intercity": "Motor Vehicle Operators",
    "Bus Drivers, School": "Motor Vehicle Operators",
    "Driver/Sales Workers": "Motor Vehicle Operators",
    "Truck Drivers, Heavy and Tractor-Trailer": "Motor Vehicle Operators",
    "Truck Drivers, Light or Delivery Services": "Motor Vehicle Operators",
    "Taxi Drivers and Chauffeurs": "Motor Vehicle Operators",
    "Motor Vehicle Operators, All Other": "Motor Vehicle Operators",
    "Locomotive Engineers": "Rail Transportation Workers",
    "Locomotive Firers": "Rail Transportation Workers",
    "Rail Yard Engineers, Dinkey Operators, and Hostlers": "Rail Transportation Workers",
    "Railroad Brake, Signal, and Switch Operators": "Rail Transportation Workers",
    "Railroad Conductors and Yardmasters": "Rail Transportation Workers",
    "Subway and Streetcar Operators": "Rail Transportation Workers",
    "Rail Transportation Workers, All Other": "Rail Transportation Workers",
    "Sailors and Marine Oilers": "Water Transportation Workers",
    "Captains, Mates, and Pilots of Water Vessels": "Water Transportation Workers",
    "Motorboat Operators": "Water Transportation Workers",
    "Ship Engineers": "Water Transportation Workers",
    "Bridge and Lock Tenders": "Other Transportation Workers",
    "Parking Lot Attendants": "Other Transportation Workers",
    "Service Station Attendants": "Other Transportation Workers",
    "Traffic Technicians": "Other Transportation Workers",
    "Transportation Inspectors": "Other Transportation Workers",
    "Transportation Workers, All Other": "Other Transportation Workers",
    "Conveyor Operators and Tenders": "Material Moving Workers",
    "Crane and Tower Operators": "Material Moving Workers",
    "Dredge Operators": "Material Moving Workers",
    "Excavating and Loading Machine and Dragline Operators": "Material Moving Workers",
    "Loading Machine Operators, Underground Mining": "Material Moving Workers",
    "Hoist and Winch Operators": "Material Moving Workers",
    "Industrial Truck and Tractor Operators": "Material Moving Workers",
    "Cleaners of Vehicles and Equipment": "Material Moving Workers",
    "Laborers and Freight, Stock, and Material Movers, Hand": "Material Moving Workers",
    "Machine Feeders and Offbearers": "Material Moving Workers",
    "Packers and Packagers, Hand": "Material Moving Workers",
    "Gas Compressor and Gas Pumping Station Operators": "Material Moving Workers",
    "Pump Operators, Except Wellhead Pumpers": "Material Moving Workers",
    "Wellhead Pumpers": "Material Moving Workers",
    "Refuse and Recyclable Material Collectors": "Material Moving Workers",
    "Shuttle Car Operators": "Material Moving Workers",
    "Tank Car, Truck, and Ship Loaders": "Material Moving Workers",
    "Material Moving Workers, All Other": "Material Moving Workers",
    # 55 - Military Specific Occupations
}

stateAbbreviations = {
    'AL': "Alabama",
    'AK': "Alaska",
    'AZ': "Arizona",
    'AR': "Arkansas",
    'CA': "California",
    'CO': "Colorado",
    'CT': "Connecticut",
    'DE': "Delaware",
    'FL': "Florida",
    'GA': "Georgia",
    'HI': "Hawaii",
    'ID': "Idaho",
    'IL': "Illinois",
    'IN': "Indiana",
    'IA': "Iowa",
    'KS': "Kansas",
    'KY': "Kentucky",
    'LA': "Louisiana",
    'ME': "Maine",
    'MD': "Maryland",
    'MA': "Massachusetts",
    'MI': "Michigan",
    'MN': "Minnesota",
    'MS': "Mississippi",
    'MO': "Missouri",
    'MT': "Montana",
    'NE': "Nebraska",
    'NV': "Nevada",
    'NH': "New Hampshire",
    'NJ': "New Jersey",
    'NM': "New Mexico",
    'NY': "New York",
    'NC': "North Carolina",
    'ND': "North Dakota",
    'OH': "Ohio",
    'OK': "Oklahoma",
    'OR': "Oregon",
    'PA': "Pennsylvania",
    'RI': "Rhode Island",
    'SC': "South Carolina",
    'SD': "South Dakota",
    'TN': "Tennessee",
    'TX': "Texas",
    'UT': "Utah",
    'VT': "Vermont",
    'VA': "Virginia",
    'WA': "Washington",
    'WV': "West Virginia",
    'WI': "Wisconsin",
    'WY': "Wyoming",
    # U.S. Commonwealth/Territories
    'AS': "American Samoa",
    'DC': "District of Columbia",
    'FM': "Federated States of Micronesia",
    'GU': "Guam",
    'MH': "Marshall Islands",
    'MP': "Northern Mariana Islands",
    'PW': "Palau",
    'PR': "Puerto Rico",
    'VI': "Virgin Islands",
    # Others
    'BC': "British Columbia"
}

def getProcessingTime(receivedDate, decisionDate):
    if(receivedDate == ""):
        return "N/A"
    date_format = "%m/%d/%y"
    received = datetime.strptime(receivedDate, date_format)
    decision = datetime.strptime(decisionDate, date_format)
    difference = decision - received
    return difference.days

def rightFormat(code):
    if re.search(r'\d\d\d\d', code):
        return True
    else:
        return False

def getStateName(state):
    if(state in stateAbbreviations):
        return stateAbbreviations[state].title()
    else:
        return state.title() #Capitalize only the first letter of the word

def occupationClassify(code):
    shortenCode = code[:2]
    return occupationClassifications[str(shortenCode)]

def normalizePayUnit(unit):
    firstLetter = unit[:1].lower()
    if firstLetter == 'b':
        return "Bi-Weekly"
    elif firstLetter == 'h':
        return "Hourly"
    elif firstLetter == 'm':
        return "Monthly"
    elif firstLetter == 'w':
        return "Weekly"
    elif firstLetter == 'y':
        return "Yearly"
    else:
        return ""

def calculateWage(amount, unit):
    amount = float(amount)
    if unit == "Bi-Weekly":
        return amount * 26
    elif unit == "Hourly":
        return amount * 2080
    elif unit == "Monthly":
        return amount * 12
    elif unit == "Weekly":
        return amount * 52
    elif unit == "Yearly":
        return amount * 1
    
def normalizeWage(pw, pwunit, offerfrom, offerto, offerunit):
    # if pwunit == "" and offerunit == "":
    #     return "N/A"
    # elif offerunit == "" and pw != "":
    #     return calculateWage (pw, pwunit)
    # elif offerunit != "":
    #     if offerfrom != "":
    #         return calculateWage(offerfrom, offerunit)
    #     elif offerto != "":
    #         return calculateWage(offerto, offerunit)
    #     elif pw != "" and pwunit != "":
    #         return calculateWage(pw, pwunit)
    #     else:
    #         return "N/A"
    if offerfrom != "" and offerunit != "":
        return calculateWage(offerfrom, offerunit)
    elif offerto != "" and offerunit != "":
        return calculateWage(offerto, offerunit)
    elif pw != "" and pwunit != "":
        return calculateWage(pw, pwunit)
    else:
        return "N/A"

wrongTitle = []

with open(newFile, 'wb') as csvFinal:
    writer = csv.writer(csvFinal)
    with open(currentFile, 'rb') as csvData:
        reader = csv.reader(csvData)
        header = reader.next()
        headerRow = [header[1], header[2], header[3], header[4], header[5], 'processing_time', header[6], header[8], header[9], header[10], header[11], header[12], header[13], 'pw_occupation_group', header[14], header[15], header[17], header[18], header[19], header[20], header[21], "wage"]
        writer.writerow(headerRow)
        rows = [row for row in reader if row]
        print len(rows)
        count = 0
        for row in rows:
            if(row[13] != ""):
                row[13] = row[13][:7].replace("-", "")
                occupationClass = occupationClassify(row[13])
            else:
                row[13] = ""
                occupationClass = ""
            processingTime = str(getProcessingTime(row[1], row[5]))
            row[6] = row[6].replace(",", "").title() #Replacing ',' character in "Employer_city"
            row[9] = getStateName(row[9])
            row[10] = row[10].replace(",", "").title()
            row[11] = getStateName(row[11])
            if(row[15] == ""):
                if row[14] in occupationSubGroup:
                    row[15] = occupationSubGroup[row[14]]
                else:
                    if row[14] not in wrongTitle:
                        wrongTitle.append(row[14])
                    row[15] = "N/A"
            row[17] = row[17].replace(",", "")
            row[18] = normalizePayUnit(row[18])
            row[19] = row[19].replace(",", "")
            row[20] = row[20].replace(",", "")
            if row[19] == "":
                row[19] = row[22].replace(",", "")
            if row[20] == "":
                row[20] = row[23].replace(",", "")
            if row[21] == "":
                row[21] = row[24].replace(",", "")
            row[21] = normalizePayUnit(row[21])

            annualWage = normalizeWage(row[17], row[18], row[19], row[20], row[21])

            inputRow = [row[1], row[2], row[3], row[4], row[5], processingTime, row[6], row[8], row[9], row[10], row[11], row[12], row[13], occupationClass, row[14], row[15], row[17], row[18], row[19], row[20], row[21], annualWage]
            # count += 1
            writer.writerow(inputRow)
        print count
    
    # Closing csv files
        csvData.close()
    csvFinal.close()

print len(wrongTitle)